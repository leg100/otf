{{ define "search-dropdown" }}
  {{ $width := dict "narrow" "w-40" "wide" "w-80" }}
  <script src="{{ addHash "/static/js/search_dropdown.js" }}"></script>
  <form id="search-dropdown" action="{{ .Action }}" method="POST"></form>
  <div
      x-data="search_dropdown({{ toJson .Existing }}, {{ toJson .Available }})"
      x-ref="searchdrop"
      @keydown.escape.prevent.stop="close($refs.button)"
      @focusin.window="! $refs.searchdrop.contains($event.target) && close()"
      @click.outside="close()"
      x-id="['dropdown-button']"
      class="relative"
      >
    <input
        @focusin="open = true"
        x-model="search"
        type="text"
        x-ref="button"
        @click="open = true"
        :aria-expanded="open"
        :aria-controls="$id('dropdown-button')"
        class="flex items-center {{ $width }} gap-2 bg-white px-2 py-1 border"
        placeholder="{{ .Placeholder }}"
        form="search-dropdown"
        name="{{ .Name }}"
        >
    <div
        x-ref="panel"
        x-show="open"
        x-transition.origin.top.left
        :id="$id('dropdown-button')"
        x-cloak
        class="absolute {{ $width }} mt-1 bg-white border border-black overflow-x-auto"
        >
        <div class="sticky bottom-0 flex flex-col">
          <button form="search-dropdown" class="text-left focus:bg-gray-200 hover:bg-gray-200 py-1 px-2" name="{{ .Name }}" :value="search" x-show="isNew">
            Create:<span class="" x-text="search"></span>
          </button>

          <template x-for="item in filterAvailable" :key="item">
            <button form="search-dropdown" class="text-left focus:bg-gray-200 hover:bg-gray-200 py-1 px-2" name="{{ .Name }}" :value="item" x-text="item"></button>
          </template>
        </div>
    </div>
  </div>
{{ end }}
