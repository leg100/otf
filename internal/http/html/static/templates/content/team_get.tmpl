{{ template "layout" . }}

{{ define "content-header-title" }}
  <a href="{{ teamsPath .Organization }}">teams</a>
  /
{{ .Team.Name }}{{ end }}

{{ define "content" }}
  {{ if .CanUpdateTeam }}
    <h3 class="font-semibold my-2 text-lg">Permissions</h3>
    <form class="flex flex-col gap-5" action="{{ updateTeamPath .Team.ID.String }}" method="POST">
      <div class="form-checkbox">
        <input
          class="checkbox"
          type="checkbox"
          name="manage_workspaces"
          id="manage_workspaces"
          value="true"
          {{ if or .Team.OrganizationAccess.ManageWorkspaces .Team.IsOwners }}checked{{ end }}
          {{ if .Team.IsOwners }}title="cannot change permissions of owners team" disabled{{ end }}
        >
        <label for="manage_workspaces">Manage Workspaces</label>
        <span class="description">Allows members to create and administrate all workspaces within the organization.</span>
      </div>
      <div class="form-checkbox">
        <input
          class="checkbox"
          type="checkbox"
          name="manage_vcs"
          id="manage_vcs"
          value="true"
          {{ if or .Team.OrganizationAccess.ManageVCS .Team.IsOwners }}checked{{ end }}
          {{ if .Team.IsOwners }}title="cannot change permissions of owners team" disabled{{ end }}
        >
        <label for="manage_vcs">Manage VCS Settings</label>
        <span class="description">Allows members to manage the set of VCS providers available within the organization.</span>
      </div>
      <div class="form-checkbox">
        <input
          class="checkbox"
          type="checkbox"
          name="manage_modules"
          id="manage_modules"
          value="true"
          {{ if or .Team.OrganizationAccess.ManageModules .Team.IsOwners }}checked{{ end }}
          {{ if .Team.IsOwners }}title="cannot change permissions of owners team" disabled{{ end }}
        >
        <label for="manage_modules">Manage Modules</label>
        <span class="description" for="manage_modules">Allows members to publish and delete modules within the organization.</span>
      </div>
      {{ if not .Team.IsOwners }}
        <div class="field">
          <button class="btn w-40">Save changes</button>
        </div>
      {{ end }}
    </form>
    <hr class="my-4">
  {{ end }}
  <h3 class="font-semibold my-2 text-lg">Members</h3>
  {{ if .CanAddMember }}
    {{ template "search-dropdown" .AddMemberDropdown }}
  {{ end }}
  <div id="content-list">
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>ID</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
      {{ range .Members }}
        <tr id="item-user-{{ .Username }}">
          <td id="username">{{ .Username }}</td>
          <td>
            {{ template "identifier" . }}
          </td>
          <td>
            {{ if $.CanRemoveMember }}
              <form action="{{ removeMemberTeamPath $.Team.ID.String }}" method="POST">
                <input type="hidden" name="username" id="delete-username" value="{{ .Username }}">
                <button id="remove-member-button" class="btn btn-error btn-xs">
                  Remove member
                </button>
              </form>
            {{ end }}
          </td>
        </tr>
      {{ else }}
        The team currently has no members.
      {{ end }}
    </table>
  </div>
  {{ if and (not .Team.IsOwners) .CanDeleteTeam }}
    <hr class="my-4">
    <h3 class="font-semibold my-2 text-lg">Advanced</h3>
    <form action="{{ deleteTeamPath .Team.ID.String }}" method="POST">
      <button class="btn btn-error"
        onclick="return confirm('Are you sure you want to delete?')">Delete team</button>
      <input type="hidden" name="id" value="{{ .Team.ID }}">
    </form>
  {{ end }}
{{ end }}
